<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:MusicPlayer.Models"
             x:Class="MusicPlayer.Views.SearchPage">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="100"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <VerticalStackLayout Grid.Row="1" Spacing="20">
            <VerticalStackLayout>
                <Label Text="Busca" FontSize="24" FontFamily="SegoeWP-Light" Margin="0,0,0,10"/>
                <SearchBar Placeholder="Música, Artista ou album"
                           SearchCommand="{Binding SearchCommand}" 
                           Text="{Binding SearchText, Mode=TwoWay}"
                           PlaceholderColor="Gray"/>
            </VerticalStackLayout>

            <CollectionView SelectionMode="Single"
                 ItemsSource="{Binding Musics}"
                 SelectedItem="{Binding MusicsSelected}"
                 SelectionChangedCommand="{Binding SelectItemCommand, Mode=TwoWay}">

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:MusicInfo">
                        <Grid Padding="5" 
                              ColumnDefinitions="80, *, Auto" 
                              VerticalOptions="Center">

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Transparent"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>


                            <!-- Imagem da capa do álbum -->
                            <Image Grid.Column="0"
                                   WidthRequest="70" HeightRequest="70"
                                   Aspect="AspectFill"
                                   Source="{Binding CoverUrlAbsolute}" />

                            <!-- Título e artista -->
                            <VerticalStackLayout Grid.Column="1" Padding="10,0">
                                <Label Text="{Binding Title}" FontAttributes="Bold" />
                                <Label Text="{Binding Artist}" FontSize="12" />
                            </VerticalStackLayout>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </Grid>

</ContentView>
